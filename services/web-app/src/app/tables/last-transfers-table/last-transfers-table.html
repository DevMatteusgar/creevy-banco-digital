<div class="container fade-in">
  <div class="card">
    <div class="header">
      <div class="header-content">
        <div class="header-text">
          <h1>Registro de Transações</h1>
          <p>Últimas 5 transações</p>
        </div>
        <button
          class="btn-recarregar"
          (click)="recarregarTabela()"
          [disabled]="carregando"
          [class.carregando]="carregando"
        >
          <span class="icone-recarregar" [class.girando]="carregando">↻</span>
          {{ carregando ? 'Carregando...' : 'Recarregar' }}
        </button>
      </div>
    </div>

    <div class="content">
      <!-- Mensagem de erro -->
      <div *ngIf="erro" class="mensagem-erro">
        {{ erro }}
      </div>

      <table>
        <thead>
        <tr>
          <th>Data</th>
          <th>Operação</th>
          <th>Remetente</th>
          <th>Destinatário</th>
          <th>CPF</th>
          <th class="text-right">Valor</th>
        </tr>
        </thead>

        <tbody>
        <tr
          *ngFor="let transacao of transacoesLimitadas; let i = index"
          class="linha-animada"
          [style.animation-delay]="i * 0.1 + 's'"
        >
          <td>{{ formatarData(transacao.date) }}</td>

          <td class="operacao">
            {{
              transacao.operationType === 'Deposit'
                ? 'Depósito'
                : transacao.operationType === 'TransferSend'
                  ? 'Transferência enviada'
                  : transacao.operationType === 'TransferReceive'
                    ? 'Transferência recebida'
                    : transacao.operationType
            }}
          </td>

          <!-- Remetente -->
          <td>{{ transacao.senderName }}</td>

          <!-- Destinatário -->
          <td>{{ transacao.receiverName }}</td>

          <!-- CPF -->
          <td>{{ transacao.receiverCpf }}</td>

          <!-- Valor (sem seta, com cor) -->
          <td
            class="valor"
            [ngClass]="{
              negativo: transacao.operationType === 'TransferSend',
              positivo: transacao.operationType !== 'TransferSend'
            }"
          >
            {{
              transacao.operationType === 'TransferSend'
                ? '-' + formatarValor(transacao.amount)
                : formatarValor(transacao.amount)
            }}
          </td>
        </tr>

        <tr *ngIf="transacoesLimitadas.length === 0 && !carregando">
          <td colspan="6" class="empty">Nenhuma transação disponível</td>
        </tr>

        <tr *ngIf="carregando">
          <td colspan="6" class="empty">Carregando transações...</td>
        </tr>
        </tbody>
      </table>

      <div class="footer">
        <p>Total de transações: <strong>{{ transfers.length }}</strong></p>
        <p class="total">
          <span>Volume total: </span>
          <strong>{{ formatarValor(valorTotal) }}</strong>
        </p>
      </div>
    </div>
  </div>
</div>
