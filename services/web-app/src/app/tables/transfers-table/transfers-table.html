<div class="container fade-in">
  <div class="card">
    <div class="header">
      <h1>Extrato Banc√°rio</h1>
      <p>Visualize suas transfer√™ncias e dep√≥sitos</p>
    </div>

    <!-- FILTROS -->
    <div class="filtros">
      <div class="filtro-destinatario">
        <label for="destinatario">Destinat√°rio:</label>
        <input
          type="text"
          id="destinatario"
          placeholder="Buscar por nome..."
          [(ngModel)]="filtros.destinatario"
          (ngModelChange)="aplicarFiltros()"
        />
      </div>

      <div class="filtros-horizontal">
        <div class="filtro-grupo">
          <label for="dataMin">Data M√≠nima:</label>
          <input
            type="date"
            id="dataMin"
            [(ngModel)]="filtros.dataMin"
            (ngModelChange)="aplicarFiltros()"
          />
        </div>

        <div class="filtro-grupo">
          <label for="dataMax">Data M√°xima:</label>
          <input
            type="date"
            id="dataMax"
            [(ngModel)]="filtros.dataMax"
            (ngModelChange)="aplicarFiltros()"
          />
        </div>

        <div class="filtro-grupo">
          <label for="valorMin">Valor M√≠nimo:</label>
          <input
            type="number"
            id="valorMin"
            placeholder="R$ 0,00"
            [(ngModel)]="filtros.valorMin"
            (ngModelChange)="aplicarFiltros()"
            step="0.01"
          />
        </div>

        <div class="filtro-grupo">
          <label for="valorMax">Valor M√°ximo:</label>
          <input
            type="number"
            id="valorMax"
            placeholder="R$ 0,00"
            [(ngModel)]="filtros.valorMax"
            (ngModelChange)="aplicarFiltros()"
            step="0.01"
          />
        </div>

        <button class="btn-limpar" (click)="limparFiltros()">Limpar Filtros</button>
      </div>
    </div>

    <!-- TABELA -->
    <div class="content">
      <table>
        <thead>
        <tr>
          <th>Data</th>
          <th>Opera√ß√£o</th>
          <th>Destinat√°rio</th>
          <th>CPF</th>
          <th class="text-right">Valor</th>
        </tr>
        </thead>

        <tbody>
        <tr *ngFor="let transacao of transacoesFiltradas">
          <!-- Data -->
          <td>{{ formatarData(transacao.date) }}</td>

          <!-- Opera√ß√£o (sem badge) -->
          <td class="operacao">
            {{
              transacao.operationType === 'Deposit'
                ? 'Dep√≥sito'
                : transacao.operationType === 'TransferSend'
                  ? 'Transfer√™ncia enviada'
                  : transacao.operationType === 'TransferReceive'
                    ? 'Transfer√™ncia recebida'
                    : transacao.operationType
            }}
          </td>

          <!-- Destinat√°rio -->
          <td>{{ transacao.receiverName }}</td>

          <!-- CPF -->
          <td>{{ transacao.receiverCpf }}</td>

          <!-- Valor com seta e cor -->
          <td
            class="valor"
            [ngClass]="{
                negativo: transacao.operationType === 'TransferSend',
                positivo: transacao.operationType !== 'TransferSend'
              }"
          >
              <span
                class="seta"
                [ngClass]="{
                  verde: transacao.operationType !== 'TransferSend',
                  vermelha: transacao.operationType === 'TransferSend'
                }"
              >
                {{ transacao.operationType === 'TransferSend' ? 'üîª' : 'üî∫' }}
              </span>

            {{
              transacao.operationType === 'TransferSend'
                ? '-' + formatarValor(transacao.amount)
                : formatarValor(transacao.amount)
            }}
          </td>
        </tr>

        <tr *ngIf="transacoesFiltradas.length === 0">
          <td colspan="5" class="empty">Nenhuma transa√ß√£o dispon√≠vel</td>
        </tr>
        </tbody>
      </table>

      <!-- FOOTER -->
      <div class="footer">
        <p>Total de transa√ß√µes: <strong>{{ transacoesFiltradas.length }}</strong></p>
        <p class="total">
          <span>Valor total: </span>
          <strong>{{ formatarValor(valorTotal) }}</strong>
        </p>
      </div>
    </div>
  </div>
</div>
