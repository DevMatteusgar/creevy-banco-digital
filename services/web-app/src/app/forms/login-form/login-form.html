<div class="form-container">
  <div class="header-container">
    <svg class="header-icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
      <circle cx="9" cy="7" r="4"></circle>
      <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
      <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
    </svg>
    <h2>Creevy Digital</h2>
  </div>

  <!-- Mensagem de erro do backend -->
  <div class="error-message" *ngIf="errorMessage">
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="10"></circle>
      <line x1="12" y1="8" x2="12" y2="12"></line>
      <line x1="12" y1="16" x2="12.01" y2="16"></line>
    </svg>
    <span>{{ errorMessage }}</span>
  </div>

  <form [formGroup]="loginForm" (ngSubmit)="onSubmit()">

    <!-- CPF -->
    <div class="form-group">
      <label for="cpf">CPF:</label>
      <input
        id="cpf"
        type="text"
        formControlName="cpf"
        placeholder="000.000.000-00"
        [class.invalid]="cpf?.invalid && cpf?.touched"
      />
      <div class="error" *ngIf="cpf?.invalid && cpf?.touched">
        <small *ngIf="cpf?.errors?.['required']">CPF é obrigatório</small>
        <small *ngIf="cpf?.errors?.['invalidCpf']">CPF inválido</small>
      </div>
    </div>

    <!-- Senha -->
    <div class="form-group">
      <label for="password">Senha (4 dígitos numéricos):</label>
      <input
        id="password"
        type="password"
        formControlName="password"
        maxlength="4"
        [class.invalid]="password?.invalid && password?.touched"
      />
      <div class="error" *ngIf="password?.invalid && password?.touched">
        <small *ngIf="password?.errors?.['required']">Senha é obrigatória</small>
        <small *ngIf="password?.errors?.['nonNumeric']">Senha deve conter apenas números</small>
        <small *ngIf="password?.errors?.['minLength']">Senha deve ter no mínimo 4 dígitos</small>
        <small *ngIf="password?.errors?.['maxLength']">Senha deve ter no máximo 4 dígitos</small>
      </div>
    </div>

    <!-- Botões -->
    <div class="form-actions">
      <button
        type="submit"
        [disabled]="loginForm.invalid || loading"
        class="btn-submit"
      >
        <span *ngIf="!loading">Login</span>
        <span *ngIf="loading" class="loading-spinner">
          <svg class="spinner" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 12a9 9 0 1 1-6.219-8.56"/>
          </svg>
          Carregando...
        </span>
      </button>
      <button
        type="button"
        (click)="resetForm()"
        class="btn-reset"
        [disabled]="loading"
      >
        Limpar
      </button>
    </div>

  </form>

  <!-- Link para Registro -->
  <div class="login-link">
    <p>Ainda não possui uma conta? <a routerLink="/register">Clique aqui</a></p>
  </div>

  <!-- Resultado -->
  <div class="result" *ngIf="submitted && !errorMessage">
    <h3>Login realizado com sucesso!</h3>
    <p>Redirecionando...</p>
  </div>
</div>
